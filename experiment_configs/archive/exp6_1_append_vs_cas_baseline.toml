# Experiment 6.1: Append vs CAS Baseline
#
# Research Question: How does append mode compare to CAS mode under baseline conditions?
#
# Setup:
# - 10 tables with append-based catalog commits
# - False conflicts only (real_conflict_probability = 0.0)
# - Compare with CAS mode by changing catalog.mode = "cas"
#
# Expected Results:
# - Append mode should have higher success rate at high contention
# - Append mode should have lower retry count for multi-table workloads
# - Both modes should converge at low contention
#
# How to Run:
# Compare append vs CAS by running with mode = "append" and mode = "cas"
# Vary inter_arrival.scale to sweep offered load

[simulation]
duration_ms = 3600000  # 1 hour
output_path = "results.parquet"
# seed = 42  # Set for determinism

[experiment]
label = "exp6_1_append_vs_cas"

[catalog]
num_tables = 10
num_groups = 1
mode = "append"  # Change to "cas" for comparison
compaction_threshold = 16000000  # 16MB
log_entry_size = 100

[transaction]
retry = 10

runtime.min = 30000   # 30 seconds
runtime.mean = 180000  # 3 minutes
runtime.sigma = 1.5

# **SWEEP THIS PARAMETER** to vary offered load
inter_arrival.distribution = "exponential"
inter_arrival.scale = 500.0  # ~2 txn/sec

ntable.zipf = 2.0
seltbl.zipf = 1.4
seltblw.zipf = 1.2

# FALSE CONFLICTS ONLY
real_conflict_probability = 0.0

conflicting_manifests.distribution = "exponential"
conflicting_manifests.mean = 3.0
conflicting_manifests.min = 1
conflicting_manifests.max = 10

[storage]
max_parallel = 4
min_latency = 1

# Near-instant catalog operations
T_CAS.mean = 1
T_CAS.stddev = 0.1

T_METADATA_ROOT.read.mean = 1
T_METADATA_ROOT.read.stddev = 0.1
T_METADATA_ROOT.write.mean = 1
T_METADATA_ROOT.write.stddev = 0.1

# Realistic storage latencies
T_MANIFEST_LIST.read.mean = 50
T_MANIFEST_LIST.read.stddev = 5
T_MANIFEST_LIST.write.mean = 60
T_MANIFEST_LIST.write.stddev = 6

T_MANIFEST_FILE.read.mean = 50
T_MANIFEST_FILE.read.stddev = 5
T_MANIFEST_FILE.write.mean = 60
T_MANIFEST_FILE.write.stddev = 6

# Append mode latencies
T_APPEND.mean = 50
T_APPEND.stddev = 5
T_LOG_ENTRY_READ.mean = 5
T_LOG_ENTRY_READ.stddev = 1
T_COMPACTION.mean = 200
T_COMPACTION.stddev = 20
